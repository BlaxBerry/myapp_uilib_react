import { Meta, Title, Subtitle, Controls, Story } from "@storybook/blocks";
import * as Stories from "./index.stories";

<Meta of={Stories} />

<Title>\<FormItem></Title>

<Subtitle>表单元素</Subtitle>

```tsx
import { FormItem, type FormItemProps } from "myapp_uilib_react";
```

<Controls />

## 基本使用

<div className="my-code-block">
  <Story of={Stories.BaseExample} />
</div>

```tsx
import React from "react";
import { FormItem } from "myapp_uilib_react";

function App() {
  return (
    <form>
      <FormItem id="xxx" label="xxx" />
    </form>
  );
}
```

## 输入内容验证

### 受控组件写法

<div className="my-code-block">
  <Story of={Stories.ErrorControlledExample} />
</div>

```tsx
import React from "react";
import { FormItem } from "myapp_uilib_react";

const sensitiveWords = ["fuck", "shit"];
const sensitiveRegex = new RegExp(sensitiveWords.join("|"), "gi");

function App() {
  const [value, setValue] = React.useState<string>("");
  const onChange: React.ChangeEventHandler<HTMLInputElement> =
    React.useCallback((e) => setValue(e.target.value), []);

  const isError = React.useMemo<boolean>(() => {
    return sensitiveRegex.test(value);
  }, [value]);

  return (
    <FormItem
      value={value}
      onChange={onChange}
      error={isError}
      errorText={isError ? "Hi! watch your mouth" : " "}
    />
  );
}
```

### 非控组件写法

- 可使用 ref 处理
- 在`<Form>`表单中时可使用`onSubmit`提交

<div className="my-code-block">
  <Story of={Stories.ErrorUncontrolledExample} />
</div>

```tsx
import React from "react";
import { FormItem } from "myapp_uilib_react";

const sensitiveWords = ["fuck", "shit"];
const sensitiveRegex = new RegExp(sensitiveWords.join("|"), "gi");

function App() {
  const [isError, setIsError] = React.useState<boolean>(false);

  const onSubmit: React.FormEventHandler<HTMLFormElement> = (e) => {
    e.stopPropagation();
    e.preventDefault();
    const value = e.currentTarget.xxx.value;
    if (sensitiveRegex.test(value)) {
      setIsError(true);
      // ...
      return;
    }
    // ...
  };

  return (
    <form onSubmit={onSubmit}>
      <FormItemComponent
        id="xxx"
        label="Label"
        error={isError}
        errorText={isError ? "Hi! watch your mouth" : " "}
      />
      <button type="submit">Submit</button>
    </form>
  );
}
```

<style>
  {`
    /* personal code bloack */
    .my-code-block {
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  `}
</style>
